<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="5NzYWNH5_YUg0dUV2iCzg_bSo7M1lLJi6IzOeF2dGXM" />
    <title>モスロギア 神託のメソロギア デッキメーカー</title>
    <link href="favicon.ico" rel="icon" type="image/png" />
    <!-- 検索キーワード -->
    <meta name="keywords" content=
    "カードゲーム,デッキメーカー,DCG,神託のメソロギア,メソロギア,神託,デッキ分析,一覧,モスロギア">
    <!-- ページの説明（検索結果の下に表示） -->
    <meta name="description" content=
    "このサイトは、アプリ「神託のメソロギア」のカード一覧、デッキ構築、デッキ分析ができる非公式サイトです。カード検索やデッキ管理をスマホでも快適に！">


        <!-- OGP基本 -->
        <meta property="og:title" content="モスロギア | 神託のメソロギア デッキメーカー">
        <meta property="og:description" content="このサイトはアプリ「神託のメソロギア」のカード検索・デッキ構築ができる非公式サイトです。">
        <meta property="og:image" content="https://mosurogia.github.io/mesorogia-cards/img/deckmakerogp.webp">
        <meta property="og:url" content="https://mosurogia.github.io/mesorogia-cards/">
        <meta property="og:type" content="website">

        <!-- Twitterカード向け -->
        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:title" content="モスロギア | 神託のメソロギア デッキメーカー">
        <meta name="twitter:description" content="カード検索とデッキ構築で神託のメソロギアをもっと楽しもう！">
        <meta name="twitter:image" content="https://mosurogia.github.io/mesorogia-cards/img/deckmakerogp.webp">


    <!-- CSS -->
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/common-page12.css">
    <link rel="stylesheet" href="css/common-page23.css">
    <link rel="stylesheet" href="css/page2.css">

<!--棒グラフ外部リソース-->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>

<!--画像生成-->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
</head>

<body>
<!-- ヘッダー -->
<header class="main-header">
    <div class="header-logo">
        <img src="img/tatudosi.webp" alt="神託のメソロギア ロゴ" />
    </div>
    <nav class="header-nav">
        <a href="index.html">📖 一覧</a>
        <a class="active-page" href="deckmaker.html">🃏 デッキメーカー</a>
        <a href="cardcheker.html">📊 所持率チェッカー</a>
        <a href="deck-post.html">📤 デッキ投稿</a>
    </nav>
</header>

<!--タブ切り替え-->
<div class="tab-bar">
    <div id="tab1" class="tab active" onclick="switchTab('build', this)">
        <span>🃏 デッキ構築</span>
    </div>
    <div id="tab2" class="tab" onclick="switchTab('edit', this)">
        <span>💾 デッキ分析</span>
    </div>
</div>

<!--デッキ構築タブ-->
<div class="tab-content active" id="build">

    <!--メニューバー＆デッキバー上部固定用-->
    <div class="fixed-top-bar">
        <!--メニューバー-->
        <div class="search-bar">
            <input id="keyword" oninput="applyFilters()" placeholder="カード検索" type="text">
            <button id="toggleOwnedBtn" onclick="toggleOwned()">所持カード未反映</button>
            <select id="sort-select" onchange="sortCards()">
                <option value="default">通常順</option>
                <option value="cost-asc">コスト昇順</option>
                <option value="cost-desc">コスト降順</option>
                <option value="power-asc">パワー昇順</option>
                <option value="power-desc">パワー降順</option>
                <option value="category-order">カテゴリ順</option>
            </select>
            <button onclick="openFilterModal()">📊 フィルター</button>
        </div>

        <!--フィルターモーダル-->
        <div class="modal" id="filterModal">
            <div class="modal-content">
                <h3 class="filter-maintitle">フィルター内容</h3>
                <div id="main-filters">
                    <!--フィルターボタン内容-->
                </div>
                <!-- 詳細フィルター -->
                <h4 class="filter-subtitle">さらに詳しい条件フィルター</h4>
                <div id="detail-filters"></div>

                <!--下部ボタン-->
                <div class="modal-footer">
                    <button class="modal-buttun" id="applyFilterBtn">この条件で絞り込む</button>
                    <button class="modal-buttun" onclick="resetFilters()">リセット</button>
                </div>
            </div>
        </div>


<!--デッキバー-->
<!-- 🔽 デッキバー全体のラッパーを追加 -->
<div class="deck-bar-wrapper">
    <div class="deck-bar-scroll">
        <div class="deck-bar-content">
            <div class="deck-bar-top" id="deckBarTop">
                <div id="deck-empty-text">
                    <div style="font-size: 0.7rem;">カード操作</div>
                    <div class="deck-help" id="deckHelp">
                        <div>
                            【PC】<br>
                            ・左クリック：追加<br>
                            ・右クリック：削除<br>
                        </div>
                        <div>
                            【スマホ】<br>
                            ・タップ,上フリック：追加<br>
                            ・下フリック：削除<br>
                            ・長押し：拡大表示
                        </div>
                    </div>
                </div>
                <!-- JSでカードが並ぶ -->
            </div>
        </div>
    </div>

    <div class="deck-summary" id="deck-summary">
        <div class="deck-info"></div>
        <div class="analyze-button-wrapper">
            <button class="analyze-button" onclick="goToAnalyzeTab()">分析</button>
            <button class="analyze-button" id="resetDeckButton">リセット</button>
        </div>
    </div>

    <button class="deck-summary-toggle" onclick="toggleDeckSummary()">◀</button>
</div>


<!--使用不可種族表示非表示ボタン-->
<div class="deck-filter-bar">
    <button id="toggle-invalid-race" class="filter-toggle-button">✅使用不可種族を表示(モノクロ)</button>
</div>
</div>

    <!--カード一覧-->
    <div class="grid" id="grid">

    </div>


<!-- カード拡大モーダル（画像のみ） -->
<div id="cardZoomModal" class="modal" style="display:none;">
    <div class="modal-content card-zoom" style="position:relative">
        <button id="cardZoomClose" aria-label="閉じる"
            style="position:absolute;right:.5rem;top:.5rem;font-size:1.25rem;">×</button>
        <img id="zoomImage" alt=""
            style="max-width:90vw;max-height:85vh;object-fit:contain;display:block;margin:auto;" />
    </div>
</div>


</div>

<!--デッキ編集タブ-->
<div class="tab-content" id="edit">
    <div id="deck-layout">
        <!--デッキリストゾーン-->
        <div id="deck-card-list" class="deck-section">
            <div id="deckcard-empty-message">デッキがここに表示されます</div>
            <!-- カード一覧（5列グリッド） -->
        </div>

        <!--デッキ情報ゾーン-->
        <div id="deck-info" class="deck-section">
            <!-- サブタブ -->
            <div class="tab-bar subtab-bar">
                <div class="tab active" onclick="switchTab('info-tab', this)"><span>📋 デッキ情報</span></div>
                <div class="tab" onclick="switchTab('post-tab', this)"><span>📤 デッキ投稿</span></div>
            </div>

            <!--タブ内-->
            <div class="tab-contents-group">
                <!-- デッキ情報タブ -->
                <div class="tab-content active" id="info-tab">
                <div class="info-section">

                    <!-- デッキ名入力欄 -->
                <div class="info-row">
                    <label class="info-label">デッキ名</label>
                    <div class="info-value">
                        <input type="text" id="info-deck-name" placeholder="デッキ名を入力">
                    </div>
                </div>

                    <!-- デッキ枚数 -->
                    <div class="info-row">
                        <div class="info-label">デッキ枚数</div>
                        <div class="info-value">
                            <span id="deck-count">0</span> /30~40
                        </div>
                    </div>

                    <!-- 代表カード -->
                    <div class="info-row">
                        <div class="info-label">メインカード</div>
                        <div class="info-value">
                            <span id="deck-representative">未選択</span>(カード画像を選択)</div>
                    </div>

                    <!-- 旧神状況 -->
                    <div class="info-row">
                        <div class="info-label">旧神</div>
                        <div class="info-value" id="deck-eldergod">未採用</div>
                    </div>

                    <!-- 使用種族 -->
                    <div class="info-row">
                        <div class="info-label">メイン種族</div>
                        <div class="info-value" id="deck-races">未選択</div>
                    </div>

                    <!--レアリティ構成-->
                    <div class="info-row">
                        <div class="info-label">レアリティ構成</div>
                        <div class="info-value" id="rarity-summary">🌈0枚/ 🟡0枚/ ⚪️0枚/ 🟤0枚</div>
                    </div>

                    <!-- 使用タイプ内訳 -->
                    <div class="info-row">
                        <div class="info-label">タイプ構成</div>
                        <div class="info-value">
                            🔵<span id="count-charger">0</span>枚/
                            🟣<span id="count-attacker">0</span>枚/
                            ⚪️<span id="count-blocker">0</span>枚
                        </div>
                    </div>

                    <!--総コスト＆パワー-->
                    <div class="info-row">
                        <div class="info-label">総コスト</div>
                        <div class="info-value"><span id="total-cost">0</span>コスト</div>
                    </div>

                    <div class="info-row">
                        <div class="info-label">総パワー</div>
                        <div class="info-value" id="total-power">🔵0 / 🟣0</div>
                    </div>

                    <!--マリガン練習 -->
                    <div class="mulligan-trainer" id="mulligan-trainer">
                        <div class="info-label">マリガンシミュレーション</div>

                        <!-- デッキ不足メッセージ -->
                        <div class="mull-warning" id="mull-warning" hidden>
                            デッキにカードを追加してください（30枚以上が必要です）
                        </div>

                        <div class="mull-layout">
                            <!-- 手札4枚 -->
                            <div class="hand-area" id="mull-hand">
                                <!-- JSで4枚分のカードが入ります -->
                            </div>

                            <!-- 操作画面 -->
                            <div class="mull-actions">
                                <button type="button" id="btn-mull-or-reset" class="btn-mulligan" disabled>手札リセット</button>
                                <div class="mull-hint">画像をタップで選択／解除できます。※選択したカードはマリガン対象から除外されます。</div>
                                <div class="mull-remaining">
                                    <div class="mull-remaining-title">残りの山札（タイプ別）</div>
                                    <ul id="mull-remaining-by-type" class="mull-remaining-list"></ul>
                                </div>

                            </div>

                        </div>
                    </div>


                    <!--グラフ分布-->
                    <div class="chart">
                        <div class="info-label">コスト分布</div>
                        <canvas id="costChart"></canvas>
                    </div>
                    <div class="chart">
                        <div class="info-label">パワー分布</div>
                        <canvas id="powerChart"></canvas>
                    </div>





                <div class="owned-info" id="owned-info">
                    <div class="owned-head">所持データ反映部分</div>
                    <div class="owned-note">※所持率チェッカーでの所持データをもとに計算しています</div>

                    <!-- 不足カード -->
                    <div class="info-row" style="justify-content:flex-start;">
                        <div class="info-label">不足枚数</div>
                        <div class="button-info">
                        <div id="shortage-summary-line">🌈0枚 / 🟡0枚 / ⚪️0枚 / 🟤0枚</div>
                        <button id="shortage-toggle-btn" type="button">不足カードリスト</button>
                        </div>

                    </div>
                    <div id="shortage-collapsible" class="shortage-collapsible" hidden>
                    </div><!-- ← 開閉式リスト -->

                    <!-- 必要ポイント/ダイヤ/砂 -->
                    <div class="info-row" style="justify-content:flex-start;">
                        <div class="info-label">必要ポイント</div>
                        <div class="button-info" >
                            <button id="exchange-toggle-btn-compact" type="button">🟢 ポイント</button>
                            <div id="exchange-values-compact" class="exchange-values">
                                <!-- ここに数値が入る（ポイント/ダイヤ/砂） -->
                            </div>
                        </div>
                    </div>
                </div>



                    <!-- 出力・保存 -->
                    <div class="deck-code-controls">
                        <button onclick="saveDeckToLocalStorage()">💾デッキ保存</button>
                        <button id="resetDeckButton">デッキリセット</button>
                        <button id="exportPngBtn">画像生成</button>
                    </div>
                    <!-- 👆ここまで“元の #deck-info 中身” -->

                </div>
                </div>

                <!-- デッキ投稿タブ -->
                <div id="post-tab" class="tab-content">
                <form id="deck-post-form" onsubmit="submitDeckPost(event)">

                    <div class="info-section">

                        <div class="info-row">
                            <label class="info-label">デッキ名</label>
                            <div class="info-value">
                                <input type="text" id="post-deck-name" placeholder="デッキ名を入力">
                            </div>
                        </div>

                        <div class="info-row">
                            <label class="info-label">デッキ枚数</label>
                            <div class="info-value">
                                <span id="post-deck-count">0</span> /30~40
                            </div>
                        </div>

                        <div class="info-row">
                            <label class="info-label">メインカード</label>
                            <div class="info-value">

                            <span id="post-representative">未選択</span>(カード画像を選択)</div>
                        </div>

                        <div class="info-row">
                            <label class="info-label">デッキ解説</label>
                            <div class="info-value">
                                <textarea id="post-note" rows="3" placeholder="デッキの特徴など（任意）"></textarea>
                            </div>
                        </div>

                        <!-- ▼ カード解説（複数可） -->
                        <div class="info-row">
                            <label class="info-label">カード解説</label>
                            <div class="info-value" style="width:100%">
                                <div id="post-card-notes">
                                    <!-- JSで行を生成 -->
                                </div>
                                <div style="display:flex; gap:.5rem; align-items:center;">
                                    <button type="button" id="add-card-note" class="add-note-btn">カード解説を追加</button>
                                    <small style="opacity:.8">※カードを選んで簡単な解説や採用理由を書けます</small>
                                </div>
                            </div>
                        </div>

                        <div class="info-row">
                            <div class="info-label">タグ</div>
                            <div class="info-value" id="post-tags">
                                <div id="auto-tags" class="tag-chips"></div>
                                <div id="select-tags" class="tag-chips"></div>
                            </div>
                        </div>

                        <div class="info-row">
                            <label class="info-label">投稿同意</label>
                            <div class="info-value">
                                <label class="agree-label">
                                    <input type="checkbox" id="post-agree">
                                    投稿内容の公開にあたって、内容にご配慮いただけることに同意します。
                                </label>
                                <small class="agree-note">
                                    ※本サイトは非公式のファンサイトです。<br>
                                    他の利用者が気持ちよく閲覧できるようご協力をお願いします。
                                </small>


                            </div>
                        </div>

                        <div class="post-actions">
                            <div id="post-status" class="status-text"></div>
                            <button type="button" onclick="previewDeckPost()">プレビュー</button>
                            <button id="post-submit" type="submit">投稿</button>
                        </div>

        <!-- ▼ カード解説：候補選択モーダル -->
        <div class="modal" id="cardNoteSelectModal" style="display:none;">
            <div class="modal-content cardnote-modal">
                <h3 class="filter-maintitle">カードを選択</h3>
                <div id="cardNoteCandidates" class="cardnote-grid"><!-- JSで5列グリッド生成 --></div>

                <div class="modal-footer" style="gap:.5rem;">
                    <button type="button" id="cardNoteClose" class="modal-buttun">閉じる</button>
                </div>
            </div>
        </div>

                        <!-- Hidden values -->
                        <input type="hidden" id="post-deck-code" name="deckCode">
                        <input type="hidden" id="post-races-hidden" name="races">
                        <input type="hidden" id="post-rep-img" name="repImg">
                        <input type="hidden" id="post-card-notes-hidden" name="cardNotes">

                    </div>
                </form>
                </div>

            </div>
        </div>

    </div>


    <!-- 保存デッキ一覧表示用 -->
    <div id="saved-deck">
            <h3 class="saved-deck-title">保存デッキ一覧</h3>
            <div id="savedDeckCount"></div>
    </div>
    <div id="savedDeckList">
        <!--保存デッキリスト-->
    </div>

        <p class="saved-deck-massage">
            ⚠️ デッキはブラウザに保存されます。キャッシュを削除するとデータが消えるのでご注意ください。
        </p>
</div>

<!--上部に戻るボタン-->
<button id="scrollTopFixed" onclick="scrollToTop()">▲</button>

<footer>
    <div>
        <p>
            <strong>モスロギア</strong> はアプリ『神託のメソロギア』の非公式ファンサイトです。<br>
            カード一覧検索やデッキメーカー、デッキ分析などを通じて、プレイヤー向けに便利なデータベース機能を提供しています。
        </p>
    </div>

    <p>
        🔗 公式サイトはこちら 👉
        <a href="https://mythologiatheoracle.com/" target="_blank" rel="noopener noreferrer">
            神託のメソロギア公式サイト
        </a>
    </p>

    © 2025 Mesorogia Cards. All rights reserved.<br />
    当サイトは「神託のメソロギア」の非公式ファンサイトです。画像・データ等の著作権は各権利者に帰属します。<br />
    一部画像素材は「ジュエルセイバーFREE」<br />
    （<a href="https://www.jewel-s.jp/" target="_blank" rel="noopener">https://www.jewel-s.jp/</a>）を使用しています。<br />
    💬 ご要望・不具合報告 👉
    <a href="https://x.com/192837465aruneo" target="_blank" rel="noopener noreferrer">
        @192837465aruneo
    </a>
</footer>


<!-- JS -->
<script src="js/common.js"></script>
<script src="js/common-page12.js"></script>
<script src="js/common-page23.js"></script>
<script src="js/common-page24.js"></script>
<script src="js/page2.js"></script>
</body>

</html>

